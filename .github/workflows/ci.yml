# name: CI/CD Pipeline

# on:
#   push:
#     branches: [ main, develop ]
#   pull_request:
#     branches: [ main ]

# jobs:
#   test:
#     runs-on: ubuntu-latest
    
#     strategy:
#       matrix:
#         node-version: [18.x, 20.x]
    
#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v4
      
#     - name: Setup Node.js ${{ matrix.node-version }}
#       uses: actions/setup-node@v4
#       with:
#         node-version: ${{ matrix.node-version }}
#         cache: 'npm'
        
#     - name: Install dependencies
#       run: npm ci
      
#     - name: Run linting
#       run: npm run lint
      
#     - name: Run unit tests
#       run: npm run test:ci
      
#     - name: Run E2E tests
#       run: npm run test:e2e
      
#     - name: Upload coverage reports
#       uses: codecov/codecov-action@v3
#       with:
#         file: ./coverage/lcov.info
        
#   build:
#     runs-on: ubuntu-latest
#     needs: test
    
#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v4
      
#     - name: Setup Node.js
#       uses: actions/setup-node@v4
#       with:
#         node-version: '20.x'
#         cache: 'npm'
        
#     - name: Install dependencies
#       run: npm ci
      
#     - name: Build components
#       run: npm run build:production
      
#     - name: Run bundle analysis
#       run: npm run build:analyze
      
#     - name: Test SSR compatibility
#       run: npm run test:ssr
      
#     - name: Build Storybook
#       run: npm run build-storybook
      
#     - name: Upload build artifacts
#       uses: actions/upload-artifact@v3
#       with:
#         name: build-artifacts
#         path: |
#           dist/
#           storybook-static/
#           reports/
          
#   deploy-storybook:
#     runs-on: ubuntu-latest
#     needs: build
#     if: github.ref == 'refs/heads/main'
    
#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v4
      
#     - name: Setup Node.js
#       uses: actions/setup-node@v4
#       with:
#         node-version: '20.x'
#         cache: 'npm'
        
#     - name: Install dependencies
#       run: npm ci
      
#     - name: Build Storybook
#       run: npm run build-storybook
      
#     - name: Deploy to GitHub Pages
#       uses: peaceiris/actions-gh-pages@v3
#       with:
#         github_token: ${{ secrets.GITHUB_TOKEN }}
#         publish_dir: ./storybook-static
        
#   release:
#     runs-on: ubuntu-latest
#     needs: [test, build]
#     if: github.ref == 'refs/heads/main' && contains(github.event.head_commit.message, 'release:')
    
#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v4
      
#     - name: Setup Node.js
#       uses: actions/setup-node@v4
#       with:
#         node-version: '20.x'
#         cache: 'npm'
#         registry-url: 'https://registry.npmjs.org'
        
#     - name: Install dependencies
#       run: npm ci
      
#     - name: Build components
#       run: npm run build:production
      
#     - name: Run final tests
#       run: |
#         npm run test:ci
#         npm run build:analyze
#         npm run test:ssr
        
#     - name: Publish to NPM
#       run: |
#         cd dist/ng-shadcn
#         npm publish --access public
#       env:
#         NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
        
#     - name: Create GitHub Release
#       uses: actions/create-release@v1
#       env:
#         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#       with:
#         tag_name: v${{ github.run_number }}
#         release_name: Release v${{ github.run_number }}
#         body: |
#           ## Changes
#           ${{ github.event.head_commit.message }}
          
#           ## Artifacts
#           - NPM Package: [@ng-shadcn/components](https://www.npmjs.com/package/@ng-shadcn/components)
#           - Storybook: [Documentation](https://your-username.github.io/ng-shadcn)
#         draft: false
#         prerelease: false
